# Sequelize ç·´ç¿’ä½œæ¥­:å€‹äººè¨˜å¸³ App

## ğŸ“ å°ˆæ¡ˆç›®æ¨™

å»ºç«‹ä¸€å€‹å€‹äººè¨˜å¸³ç³»çµ±å¾Œç«¯,ç·´ç¿’ Sequelize çš„é—œè¯è¨­è¨ˆèˆ‡å¯¦ç”¨åŠŸèƒ½é–‹ç™¼ã€‚

### æ ¸å¿ƒåŠŸèƒ½

- âœ… æ”¶æ”¯è¨˜éŒ„ç®¡ç†
- âœ… åˆ†é¡ç³»çµ± (æ”¯æ´éšå±¤)
- âœ… å¤šå¸³æˆ¶ç®¡ç† (éŒ¢åŒ… + ä¿¡ç”¨å¡)

### äº®é»åŠŸèƒ½ â­

- ğŸ”” **Email æé†’ä¿¡ç”¨å¡ç¹³è²»** - è‡ªå‹•æ’ç¨‹æª¢æŸ¥ä¸¦ç™¼é€æé†’
- ğŸ“Š **åŒ¯å‡º Excel å ±è¡¨** - ç”¢ç”Ÿå®Œæ•´çš„æ”¶æ”¯æ˜ç´°è¡¨

## ğŸ’¡ æ¥­å‹™æµç¨‹

### è¨˜å¸³æµç¨‹

```
1. é¸æ“‡äº¤æ˜“é¡å‹ â†’ æ”¶å…¥ / æ”¯å‡º
2. é¸æ“‡åˆ†é¡ â†’ é£²é£Ÿ > æ™šé¤ > ä¾¿ç•¶ (æ”¯æ´å¤šå±¤ç´š)
3. é¸æ“‡ä»˜æ¬¾æ–¹å¼ â†’ ç¾é‡‘éŒ¢åŒ… / å°æ–°ä¿¡ç”¨å¡
4. è¨˜éŒ„é‡‘é¡ â†’ è‡ªå‹•æ›´æ–°å¸³æˆ¶é¤˜é¡æˆ–ä¿¡ç”¨å¡æœªå‡ºå¸³é‡‘é¡
```

### ä¿¡ç”¨å¡æé†’æµç¨‹

```
1. æ¯å¤©æ—©ä¸Š 9:00 è‡ªå‹•æª¢æŸ¥
2. æ‰¾å‡º 3 å¤©å¾Œè¦ç¹³è²»çš„ä¿¡ç”¨å¡
3. æª¢æŸ¥æ˜¯å¦æœ‰æœªå‡ºå¸³é‡‘é¡
4. ç™¼é€ Email æé†’ä½¿ç”¨è€…
5. è¨˜éŒ„æé†’æ™‚é–“,é¿å…é‡è¤‡ç™¼é€
```

### Excel åŒ¯å‡ºæµç¨‹

```
1. ä½¿ç”¨è€…é¸æ“‡æ—¥æœŸç¯„åœ
2. æŸ¥è©¢è©²æœŸé–“æ‰€æœ‰äº¤æ˜“è¨˜éŒ„
3. åŒ…å«åˆ†é¡ã€å¸³æˆ¶ç­‰é—œè¯è³‡æ–™
4. ç”Ÿæˆ Excel æª”æ¡ˆä¸¦ä¸‹è¼‰
5. åŒ…å«æ¨£å¼ã€ç¸½è¨ˆè¨ˆç®—
```

---

## ğŸ“Š è³‡æ–™è¡¨è¨­è¨ˆ

### 1. User (ä½¿ç”¨è€…)

| æ¬„ä½              | é¡å‹            | èªªæ˜                       |
| ----------------- | --------------- | -------------------------- |
| id                | INTEGER (PK)    | ä¸»éµ                       |
| username          | STRING          | ä½¿ç”¨è€…åç¨±                 |
| email             | STRING (UNIQUE) | Email (ç”¨æ–¼ç™»å…¥å’Œç™¼é€æé†’) |
| password          | STRING          | å¯†ç¢¼ (åŠ å¯†å¾Œ)              |
| emailNotification | BOOLEAN         | æ˜¯å¦å•Ÿç”¨ Email æé†’        |
| createdAt         | DATE            | å»ºç«‹æ™‚é–“                   |
| updatedAt         | DATE            | æ›´æ–°æ™‚é–“                   |

---

### 2. Category (åˆ†é¡) - è‡ªé—œè¯è¨­è¨ˆ

| æ¬„ä½      | é¡å‹                   | èªªæ˜                    |
| --------- | ---------------------- | ----------------------- |
| id        | INTEGER (PK)           | ä¸»éµ                    |
| userId    | INTEGER (FK)           | æ‰€å±¬ä½¿ç”¨è€…              |
| name      | STRING                 | åˆ†é¡åç¨±                |
| type      | ENUM                   | 'income' æˆ– 'expense'   |
| parentId  | INTEGER (FK, nullable) | çˆ¶åˆ†é¡ ID               |
| icon      | STRING                 | åœ–ç¤ºåç¨±                |
| color     | STRING                 | é¡è‰²ä»£ç¢¼ (å¦‚ '#FF5733') |
| createdAt | DATE                   | å»ºç«‹æ™‚é–“                |
| updatedAt | DATE                   | æ›´æ–°æ™‚é–“                |

**éšå±¤çµæ§‹ç¯„ä¾‹:**

```
é£²é£Ÿ (parentId: null)
  â””â”€ æ™šé¤ (parentId: é£²é£ŸID)
      â””â”€ ä¾¿ç•¶ (parentId: æ™šé¤ID)
  â””â”€ åˆé¤ (parentId: é£²é£ŸID)
      â””â”€ è‡ªåŠ©é¤ (parentId: åˆé¤ID)

äº¤é€š (parentId: null)
  â””â”€ å¤§çœ¾é‹è¼¸ (parentId: äº¤é€šID)
      â”œâ”€ æ·é‹ (parentId: å¤§çœ¾é‹è¼¸ID)
      â””â”€ å…¬è»Š (parentId: å¤§çœ¾é‹è¼¸ID)
```

**è¨­è¨ˆé‡é»:**

- `parentId` ç‚º `null` è¡¨ç¤ºä¸»åˆ†é¡
- é€é `parentId` å»ºç«‹çˆ¶å­é—œä¿‚
- æ”¯æ´ç„¡é™å±¤ç´š (ä½†å»ºè­° 2-3 å±¤)

---

### 3. Account (å¸³æˆ¶) - çµ±ä¸€ç®¡ç†éŒ¢åŒ…å’Œä¿¡ç”¨å¡

| æ¬„ä½           | é¡å‹          | èªªæ˜                          | é©ç”¨é¡å‹  |
| -------------- | ------------- | ----------------------------- | --------- |
| id             | INTEGER (PK)  | ä¸»éµ                          | å…¨éƒ¨      |
| userId         | INTEGER (FK)  | æ‰€å±¬ä½¿ç”¨è€…                    | å…¨éƒ¨      |
| name           | STRING        | å¸³æˆ¶åç¨±                      | å…¨éƒ¨      |
| type           | ENUM          | 'cash', 'bank', 'credit_card' | å…¨éƒ¨      |
| balance        | DECIMAL(10,2) | ç•¶å‰é¤˜é¡                      | éŒ¢åŒ…/éŠ€è¡Œ |
| lastFourDigits | STRING        | å¡è™Ÿå¾Œå››ç¢¼                    | ä¿¡ç”¨å¡    |
| billingDay     | INTEGER       | å¸³å–®æ—¥ (1-31)                 | ä¿¡ç”¨å¡    |
| paymentDay     | INTEGER       | ç¹³æ¬¾æ—¥ (1-31)                 | ä¿¡ç”¨å¡    |
| creditLimit    | DECIMAL(10,2) | ä¿¡ç”¨é¡åº¦                      | ä¿¡ç”¨å¡    |
| unpaidAmount   | DECIMAL(10,2) | æœªå‡ºå¸³é‡‘é¡                    | ä¿¡ç”¨å¡    |
| lastNotifiedAt | DATE          | ä¸Šæ¬¡æé†’æ™‚é–“                  | ä¿¡ç”¨å¡    |
| isActive       | BOOLEAN       | æ˜¯å¦å•Ÿç”¨                      | å…¨éƒ¨      |
| createdAt      | DATE          | å»ºç«‹æ™‚é–“                      | å…¨éƒ¨      |
| updatedAt      | DATE          | æ›´æ–°æ™‚é–“                      | å…¨éƒ¨      |

**è¨­è¨ˆé‡é»:**

- ä½¿ç”¨ `type` æ¬„ä½å€åˆ†å¸³æˆ¶é¡å‹
- éŒ¢åŒ…/éŠ€è¡Œä½¿ç”¨ `balance` æ¬„ä½
- ä¿¡ç”¨å¡ä½¿ç”¨ `unpaidAmount` è¿½è¹¤æœªå‡ºå¸³é‡‘é¡
- `lastNotifiedAt` é¿å…åŒä¸€å¤©é‡è¤‡æé†’

---

### 4. Transaction (äº¤æ˜“è¨˜éŒ„)

| æ¬„ä½        | é¡å‹          | èªªæ˜                  |
| ----------- | ------------- | --------------------- |
| id          | INTEGER (PK)  | ä¸»éµ                  |
| userId      | INTEGER (FK)  | æ‰€å±¬ä½¿ç”¨è€…            |
| accountId   | INTEGER (FK)  | ä½¿ç”¨çš„å¸³æˆ¶            |
| categoryId  | INTEGER (FK)  | äº¤æ˜“åˆ†é¡              |
| amount      | DECIMAL(10,2) | é‡‘é¡                  |
| type        | ENUM          | 'income' æˆ– 'expense' |
| description | TEXT          | å‚™è¨»èªªæ˜              |
| date        | DATE          | äº¤æ˜“æ—¥æœŸ              |
| isBilled    | BOOLEAN       | æ˜¯å¦å·²å‡ºå¸³ (ä¿¡ç”¨å¡ç”¨) |
| createdAt   | DATE          | å»ºç«‹æ™‚é–“              |
| updatedAt   | DATE          | æ›´æ–°æ™‚é–“              |

**è¨­è¨ˆé‡é»:**

- æ‰€æœ‰äº¤æ˜“éƒ½é—œè¯åˆ°ä¸€å€‹å¸³æˆ¶
- `isBilled` ç”¨æ–¼è¿½è¹¤ä¿¡ç”¨å¡äº¤æ˜“æ˜¯å¦å·²å‡ºå¸³
- é‡‘é¡ä½¿ç”¨ `DECIMAL(10,2)` ç¢ºä¿ç²¾ç¢ºåº¦

---

## ğŸ”— é—œè¯é—œä¿‚è¨­è¨ˆ

```
User (1) â†’ (N) Category
  - ä¸€å€‹ä½¿ç”¨è€…æœ‰å¤šå€‹åˆ†é¡
  - ä½¿ç”¨ userId é—œè¯

User (1) â†’ (N) Account
  - ä¸€å€‹ä½¿ç”¨è€…æœ‰å¤šå€‹å¸³æˆ¶ (éŒ¢åŒ…/ä¿¡ç”¨å¡)
  - ä½¿ç”¨ userId é—œè¯

User (1) â†’ (N) Transaction
  - ä¸€å€‹ä½¿ç”¨è€…æœ‰å¤šç­†äº¤æ˜“è¨˜éŒ„
  - ä½¿ç”¨ userId é—œè¯

Category (1) â†’ (N) Category (è‡ªé—œè¯)
  - ä¸€å€‹åˆ†é¡å¯ä»¥æœ‰å¤šå€‹å­åˆ†é¡
  - ä½¿ç”¨ parentId é—œè¯è‡ªå·±

Category (1) â†’ (N) Transaction
  - ä¸€å€‹åˆ†é¡ä¸‹æœ‰å¤šç­†äº¤æ˜“
  - ä½¿ç”¨ categoryId é—œè¯

Account (1) â†’ (N) Transaction
  - ä¸€å€‹å¸³æˆ¶æœ‰å¤šç­†äº¤æ˜“è¨˜éŒ„
  - ä½¿ç”¨ accountId é—œè¯
```

---

## ğŸ”§ API ç«¯é»è¨­è¨ˆ

### èªè­‰ç›¸é—œ

- `POST /auth/register` - è¨»å†Šæ–°ä½¿ç”¨è€…
- `POST /auth/login` - ç™»å…¥ (å›å‚³ JWT token)
- `GET /auth/me` - å–å¾—ç•¶å‰ä½¿ç”¨è€…è³‡è¨Š
- `PUT /auth/me` - æ›´æ–°ä½¿ç”¨è€…è¨­å®š

### åˆ†é¡ç®¡ç†

- `POST /categories` - æ–°å¢åˆ†é¡ (å¯æŒ‡å®š parentId)
- `GET /categories` - å–å¾—æ‰€æœ‰åˆ†é¡ (æ¨¹ç‹€çµæ§‹)
- `GET /categories/:id` - å–å¾—å–®ä¸€åˆ†é¡
- `GET /categories/:id/children` - å–å¾—å­åˆ†é¡åˆ—è¡¨
- `PUT /categories/:id` - æ›´æ–°åˆ†é¡
- `DELETE /categories/:id` - åˆªé™¤åˆ†é¡

### å¸³æˆ¶ç®¡ç†

- `POST /accounts` - æ–°å¢å¸³æˆ¶ (éŒ¢åŒ…æˆ–ä¿¡ç”¨å¡)
- `GET /accounts` - å–å¾—æ‰€æœ‰å¸³æˆ¶
- `GET /accounts/:id` - å–å¾—å–®ä¸€å¸³æˆ¶è©³æƒ…
- `PUT /accounts/:id` - æ›´æ–°å¸³æˆ¶è³‡è¨Š
- `DELETE /accounts/:id` - åˆªé™¤å¸³æˆ¶
- `GET /accounts/summary` - å–å¾—å¸³æˆ¶ç¸½è¦½ (ç¸½é¤˜é¡ã€ç¸½æ¬ æ¬¾)

### äº¤æ˜“è¨˜éŒ„ (æ ¸å¿ƒ)

- `POST /transactions` - æ–°å¢äº¤æ˜“ (è‡ªå‹•æ›´æ–°å¸³æˆ¶é¤˜é¡)
- `GET /transactions` - å–å¾—æ‰€æœ‰äº¤æ˜“ (æ”¯æ´ç¯©é¸ã€åˆ†é )
- `GET /transactions/:id` - å–å¾—å–®ç­†äº¤æ˜“è©³æƒ…
- `PUT /transactions/:id` - æ›´æ–°äº¤æ˜“ (é‡æ–°è¨ˆç®—é¤˜é¡)
- `DELETE /transactions/:id` - åˆªé™¤äº¤æ˜“ (é‚„åŸé¤˜é¡)

### çµ±è¨ˆæŸ¥è©¢

- `GET /statistics/summary` - ç¸½è¦½ (ç¸½æ”¶å…¥ã€ç¸½æ”¯å‡ºã€æ·¨å€¼)
- `GET /statistics/monthly` - æœ¬æœˆæ”¶æ”¯çµ±è¨ˆ
- `GET /statistics/category` - åˆ†é¡æ”¯å‡ºçµ±è¨ˆ (åœ“é¤…åœ–è³‡æ–™)
- `GET /statistics/trend` - æ”¶æ”¯è¶¨å‹¢ (æœ€è¿‘ 6 å€‹æœˆ)

### Email æé†’ (äº®é»åŠŸèƒ½)

- `POST /notifications/test` - æ¸¬è©¦ç™¼é€æé†’ä¿¡
- `GET /notifications/settings` - å–å¾—æé†’è¨­å®š
- `PUT /notifications/settings` - æ›´æ–°æé†’è¨­å®š

### Excel åŒ¯å‡º (äº®é»åŠŸèƒ½)

- `GET /export/transactions` - åŒ¯å‡ºäº¤æ˜“è¨˜éŒ„ (æ”¯æ´æ—¥æœŸç¯„åœ)
- `GET /export/monthly/:year/:month` - åŒ¯å‡ºæŒ‡å®šæœˆä»½å ±è¡¨
- `GET /export/category/:categoryId` - åŒ¯å‡ºæŒ‡å®šåˆ†é¡çš„äº¤æ˜“

---

## ğŸ’¡ é—œéµæ¥­å‹™é‚è¼¯

### 1. æ–°å¢äº¤æ˜“æ™‚çš„è™•ç†

- å»ºç«‹äº¤æ˜“è¨˜éŒ„
- æ ¹æ“šå¸³æˆ¶é¡å‹æ›´æ–°é¤˜é¡:
  - éŒ¢åŒ…/éŠ€è¡Œ: æ›´æ–° `balance`
  - ä¿¡ç”¨å¡: æ›´æ–° `unpaidAmount`
- ä½¿ç”¨è³‡æ–™åº«äº¤æ˜“ (Transaction) ç¢ºä¿ä¸€è‡´æ€§

### 2. ä¿¡ç”¨å¡æé†’é‚è¼¯

- æ¯å¤©å®šæ™‚æª¢æŸ¥ (ä½¿ç”¨ node-cron)
- è¨ˆç®— 3 å¤©å¾Œçš„æ—¥æœŸ
- æ‰¾å‡º `paymentDay` ç¬¦åˆçš„ä¿¡ç”¨å¡
- æª¢æŸ¥ `unpaidAmount > 0`
- æª¢æŸ¥ä½¿ç”¨è€…çš„ `emailNotification` æ˜¯å¦å•Ÿç”¨
- æª¢æŸ¥ `lastNotifiedAt` é¿å…é‡è¤‡æé†’
- ç™¼é€ Email ä¸¦æ›´æ–° `lastNotifiedAt`

### 3. Excel åŒ¯å‡ºé‚è¼¯

- æ ¹æ“šæ—¥æœŸç¯„åœæŸ¥è©¢äº¤æ˜“
- åŒ…å«åˆ†é¡ã€å¸³æˆ¶ç­‰é—œè¯è³‡æ–™
- ç”Ÿæˆ Excel æª”æ¡ˆ:
  - è¨­å®šæ¬„ä½ (æ—¥æœŸã€é¡å‹ã€åˆ†é¡ã€å¸³æˆ¶ã€é‡‘é¡ã€å‚™è¨»)
  - å¥—ç”¨æ¨£å¼ (æ¨™é¡Œç²—é«”ã€èƒŒæ™¯è‰²)
  - è¨ˆç®—ç¸½è¨ˆ (ä½¿ç”¨å…¬å¼)
  - è¨­å®šæ•¸å­—æ ¼å¼
- å›å‚³æª”æ¡ˆä¾›ä¸‹è¼‰

### 4. åˆ†é¡éšå±¤æŸ¥è©¢

- æŸ¥è©¢ä¸»åˆ†é¡ (`parentId = null`)
- éè¿´åŒ…å«å­åˆ†é¡ (ä½¿ç”¨ Sequelize `include`)
- æˆ–ä½¿ç”¨ CTE (Common Table Expression) æŸ¥è©¢å®Œæ•´è·¯å¾‘

---

## ğŸ“¦ æ‰€éœ€æŠ€è¡“èˆ‡å¥—ä»¶

### æ ¸å¿ƒå¥—ä»¶

- `express` - Web æ¡†æ¶
- `sequelize` - ORM
- `pg` / `pg-hstore` - PostgreSQL é©…å‹•
- `bcrypt` - å¯†ç¢¼åŠ å¯†
- `jsonwebtoken` - JWT èªè­‰

### äº®é»åŠŸèƒ½å¥—ä»¶

- `nodemailer` - ç™¼é€ Email
- `node-cron` - æ’ç¨‹ä»»å‹™
- `exceljs` - ç”Ÿæˆ Excel

### å…¶ä»–

- `dotenv` - ç’°å¢ƒè®Šæ•¸ç®¡ç†
- `express-validator` - è¼¸å…¥é©—è­‰ (å¯é¸)

---

## ğŸ“Œ é‡è¦æ³¨æ„äº‹é …

### è³‡æ–™ä¸€è‡´æ€§

- æ–°å¢/æ›´æ–°/åˆªé™¤äº¤æ˜“æ™‚,å¿…é ˆä½¿ç”¨è³‡æ–™åº«äº¤æ˜“ (`sequelize.transaction()`)
- ç¢ºä¿äº¤æ˜“è¨˜éŒ„å’Œå¸³æˆ¶é¤˜é¡åŒæ™‚æˆåŠŸæˆ–å¤±æ•—

### é‡‘é¡ç²¾ç¢ºåº¦

- æ‰€æœ‰é‡‘é¡æ¬„ä½ä½¿ç”¨ `DECIMAL(10, 2)`
- é¿å…ä½¿ç”¨ `FLOAT` æˆ– `DOUBLE` (æœƒæœ‰ç²¾åº¦å•é¡Œ)

### Email è¨­å®š

- Gmail éœ€è¦ä½¿ç”¨ã€Œæ‡‰ç”¨ç¨‹å¼å¯†ç¢¼ã€
- ä¸è¦åœ¨ç¨‹å¼ç¢¼ä¸­å¯«æ­»å¯†ç¢¼,ä½¿ç”¨ç’°å¢ƒè®Šæ•¸

### æ•ˆèƒ½è€ƒé‡

- äº¤æ˜“è¨˜éŒ„å¯èƒ½å¾ˆå¤š,æŸ¥è©¢æ™‚è¦åŠ ä¸Šåˆ†é 
- Excel åŒ¯å‡ºå¤§é‡è³‡æ–™æ™‚æ³¨æ„è¨˜æ†¶é«”ä½¿ç”¨
- ç‚ºå¸¸ç”¨æŸ¥è©¢æ¬„ä½å»ºç«‹ç´¢å¼• (userId, date, categoryId)

### åˆªé™¤ä¿è­·

- åˆªé™¤åˆ†é¡å‰æª¢æŸ¥æ˜¯å¦æœ‰äº¤æ˜“ä½¿ç”¨
- åˆªé™¤å¸³æˆ¶å‰æª¢æŸ¥æ˜¯å¦æœ‰äº¤æ˜“è¨˜éŒ„
- æˆ–ä½¿ç”¨è»Ÿåˆªé™¤ (soft delete)

## âœ… ä½œæ¥­ä»»å‹™

### éšæ®µ 1: ç’°å¢ƒè¨­å®š

- [ ] å»ºç«‹å°ˆæ¡ˆ `expense-tracker-api`
- [ ] å®‰è£å¥—ä»¶: `express`, `sequelize`, `pg`, `pg-hstore`
- [ ] å®‰è£é¡å¤–å¥—ä»¶: `nodemailer`, `exceljs`, `node-cron`, `bcrypt`, `jsonwebtoken`, `dotenv`
- [ ] å»ºç«‹ 4 å€‹ Model æª”æ¡ˆ: User, Category, Account, Transaction
- [ ] åœ¨ `app.js` å®šç¾©æ‰€æœ‰é—œè¯
- [ ] åŸ·è¡Œ `sequelize.sync()` å»ºç«‹è³‡æ–™è¡¨

### éšæ®µ 2: ä½¿ç”¨è€…åŠŸèƒ½

- [ ] `POST /auth/register` - è¨»å†Šä½¿ç”¨è€… (å¯†ç¢¼éœ€åŠ å¯†)
- [ ] `POST /auth/login` - ç™»å…¥ä¸¦å›å‚³ JWT token
- [ ] `GET /auth/me` - å–å¾—ç•¶å‰ä½¿ç”¨è€…è³‡è¨Š (éœ€é©—è­‰ JWT)
- [ ] `PUT /auth/me` - æ›´æ–°ä½¿ç”¨è€…è¨­å®š (emailNotification)

### éšæ®µ 3: åˆ†é¡ç®¡ç† (è‡ªé—œè¯) â­

- [ ] `POST /categories` - æ–°å¢åˆ†é¡ (å¯æŒ‡å®š parentId å»ºç«‹å­åˆ†é¡)
- [ ] `GET /categories` - å–å¾—æ‰€æœ‰åˆ†é¡ (æ¨¹ç‹€çµæ§‹,åŒ…å«å­åˆ†é¡)
- [ ] `GET /categories/:id/children` - å–å¾—æŒ‡å®šåˆ†é¡çš„å­åˆ†é¡
- [ ] `PUT /categories/:id` - æ›´æ–°åˆ†é¡è³‡è¨Š
- [ ] `DELETE /categories/:id` - åˆªé™¤åˆ†é¡ (éœ€æª¢æŸ¥æ˜¯å¦æœ‰äº¤æ˜“ä½¿ç”¨)

**å­¸ç¿’é‡é»:**

- Sequelize è‡ªé—œè¯è¨­è¨ˆ (parentId)
- ä½¿ç”¨ `include` æŸ¥è©¢å­åˆ†é¡
- æ¨¹ç‹€çµæ§‹çš„è³‡æ–™è™•ç†

### éšæ®µ 4: å¸³æˆ¶ç®¡ç†

- [ ] `POST /accounts` - æ–°å¢å¸³æˆ¶ (æ ¹æ“š type æ±ºå®šæ˜¯éŒ¢åŒ…æˆ–ä¿¡ç”¨å¡)
- [ ] `GET /accounts` - å–å¾—æ‰€æœ‰å¸³æˆ¶
- [ ] `GET /accounts/:id` - å–å¾—å–®ä¸€å¸³æˆ¶è©³æƒ…
- [ ] `PUT /accounts/:id` - æ›´æ–°å¸³æˆ¶è³‡è¨Š
- [ ] `DELETE /accounts/:id` - åˆªé™¤å¸³æˆ¶ (éœ€æª¢æŸ¥æ˜¯å¦æœ‰äº¤æ˜“è¨˜éŒ„)
- [ ] `GET /accounts/summary` - ç¸½è¦½ (ç¸½é¤˜é¡ã€ç¸½æ¬ æ¬¾)

**å­¸ç¿’é‡é»:**

- ä½¿ç”¨ `type` æ¬„ä½å€åˆ†ä¸åŒé¡å‹çš„å¸³æˆ¶
- æ¢ä»¶å¼æ¬„ä½ä½¿ç”¨ (éŒ¢åŒ…ç”¨ balance,ä¿¡ç”¨å¡ç”¨ unpaidAmount)

### éšæ®µ 5: äº¤æ˜“è¨˜éŒ„ (æ ¸å¿ƒåŠŸèƒ½) â­â­â­

- [ ] `POST /transactions` - æ–°å¢äº¤æ˜“ä¸¦è‡ªå‹•æ›´æ–°å¸³æˆ¶é¤˜é¡
- [ ] `GET /transactions` - å–å¾—æ‰€æœ‰äº¤æ˜“ (æ”¯æ´ç¯©é¸ã€åˆ†é ã€åŒ…å«é—œè¯)
- [ ] `GET /transactions/:id` - å–å¾—å–®ç­†äº¤æ˜“è©³æƒ…
- [ ] `PUT /transactions/:id` - æ›´æ–°äº¤æ˜“ (éœ€é‡æ–°è¨ˆç®—é¤˜é¡è®ŠåŒ–)
- [ ] `DELETE /transactions/:id` - åˆªé™¤äº¤æ˜“ (éœ€é‚„åŸå¸³æˆ¶é¤˜é¡)

**å­¸ç¿’é‡é»:**

- ä½¿ç”¨ `sequelize.transaction()` ç¢ºä¿è³‡æ–™ä¸€è‡´æ€§
- æ–°å¢äº¤æ˜“æ™‚åŒæ­¥æ›´æ–°å¸³æˆ¶é¤˜é¡
- åŒ…å«å¤šå€‹é—œè¯çš„æŸ¥è©¢ (Category, Account)
- è™•ç†éŒ¢åŒ…å’Œä¿¡ç”¨å¡çš„ä¸åŒé‚è¼¯

**é—œéµé‚è¼¯:**

- éŒ¢åŒ…äº¤æ˜“: æ›´æ–° `Account.balance`
- ä¿¡ç”¨å¡äº¤æ˜“: æ›´æ–° `Account.unpaidAmount`,è¨­å®š `isBilled = false`

### éšæ®µ 6: çµ±è¨ˆæŸ¥è©¢

- [ ] `GET /statistics/summary` - ç¸½è¦½ (ç¸½æ”¶å…¥ã€ç¸½æ”¯å‡ºã€æ·¨å€¼)
- [ ] `GET /statistics/monthly` - æœ¬æœˆæ”¶æ”¯çµ±è¨ˆ
- [ ] `GET /statistics/category` - åˆ†é¡æ”¯å‡ºçµ±è¨ˆ (ç”¨æ–¼åœ“é¤…åœ–)
- [ ] `GET /statistics/trend` - æ”¶æ”¯è¶¨å‹¢ (æœ€è¿‘ 6 å€‹æœˆ,ç”¨æ–¼æŠ˜ç·šåœ–)

**å­¸ç¿’é‡é»:**

- ä½¿ç”¨ Sequelize èšåˆå‡½æ•¸ (SUM, COUNT)
- GROUP BY æŸ¥è©¢
- æ—¥æœŸç¯„åœæŸ¥è©¢ (Op.between)
- è¤‡é›œçš„çµ±è¨ˆè¨ˆç®—

### éšæ®µ 7: Email æé†’åŠŸèƒ½ â­â­â­ (äº®é» 1)

- [ ] è¨­å®š Nodemailer (ä½¿ç”¨ Gmail SMTP)
- [ ] å»ºç«‹ Email HTML æ¨¡æ¿
- [ ] å¯¦ä½œæª¢æŸ¥ä¿¡ç”¨å¡ç¹³è²»æ—¥æœŸçš„å‡½æ•¸
- [ ] ä½¿ç”¨ node-cron è¨­å®šæ¯æ—¥æ’ç¨‹ (æ¯å¤©æ—©ä¸Š 9:00)
- [ ] `POST /notifications/test` - æ¸¬è©¦ç™¼é€æé†’ä¿¡

**å­¸ç¿’é‡é»:**

- Nodemailer è¨­å®šèˆ‡ä½¿ç”¨
- node-cron æ’ç¨‹ä»»å‹™
- æ—¥æœŸè¨ˆç®— (æ‰¾å‡º 3 å¤©å¾Œè¦ç¹³è²»çš„å¡)
- é¿å…é‡è¤‡æé†’ (ä½¿ç”¨ lastNotifiedAt)

**æé†’é‚è¼¯:**

1. è¨ˆç®— 3 å¤©å¾Œçš„æ—¥æœŸ
2. æ‰¾å‡º `paymentDay` ç¬¦åˆçš„ä¿¡ç”¨å¡
3. æª¢æŸ¥ `unpaidAmount > 0` ä¸” `emailNotification = true`
4. æª¢æŸ¥ `lastNotifiedAt` é¿å…åŒä¸€å¤©é‡è¤‡ç™¼é€
5. ç™¼é€ Email ä¸¦æ›´æ–° `lastNotifiedAt`

### éšæ®µ 8: Excel åŒ¯å‡ºåŠŸèƒ½ â­â­â­ (äº®é» 2)

- [ ] å®‰è£ä¸¦è¨­å®š `exceljs`
- [ ] `GET /export/transactions` - åŒ¯å‡ºäº¤æ˜“è¨˜éŒ„ (æ”¯æ´æ—¥æœŸç¯„åœç¯©é¸)
- [ ] `GET /export/monthly/:year/:month` - åŒ¯å‡ºæŒ‡å®šæœˆä»½å ±è¡¨
- [ ] `GET /export/category/:categoryId` - åŒ¯å‡ºæŒ‡å®šåˆ†é¡çš„äº¤æ˜“

**å­¸ç¿’é‡é»:**

- ExcelJS åŸºæœ¬ä½¿ç”¨
- è¨­å®šæ¬„ä½ã€æ¨£å¼ã€æ ¼å¼
- ä½¿ç”¨å…¬å¼è¨ˆç®—ç¸½è¨ˆ
- è¨­å®š HTTP å›æ‡‰æ¨™é ­è®“ç€è¦½å™¨ä¸‹è¼‰æª”æ¡ˆ

**Excel å…§å®¹:**

- æ¬„ä½: æ—¥æœŸã€é¡å‹ã€åˆ†é¡ã€å¸³æˆ¶ã€é‡‘é¡ã€å‚™è¨»
- æ¨£å¼: æ¨™é¡Œç²—é«”ã€èƒŒæ™¯è‰²
- ç¸½è¨ˆ: ä½¿ç”¨ SUM å…¬å¼
- æ•¸å­—æ ¼å¼: `#,##0.00`

### éšæ®µ 9: æ¸¬è©¦èˆ‡å„ªåŒ–

- [ ] å»ºç«‹ç¨®å­è³‡æ–™ (Seed data) æ–¹ä¾¿æ¸¬è©¦
- [ ] æ¸¬è©¦æ‰€æœ‰ API ç«¯é» (ä½¿ç”¨ Postman æˆ–é¡ä¼¼å·¥å…·)
- [ ] æ¸¬è©¦ Email æé†’åŠŸèƒ½
- [ ] æ¸¬è©¦ Excel åŒ¯å‡º
- [ ] åŠ å…¥éŒ¯èª¤è™•ç† (try-catch)
- [ ] åŠ å…¥è¼¸å…¥é©—è­‰ (express-validator)
- [ ] ç‚ºå¸¸ç”¨æ¬„ä½å»ºç«‹è³‡æ–™åº«ç´¢å¼•

---

## ğŸ¯ å­¸ç¿’é‡é»ç¸½çµ

### Sequelize æŠ€å·§

1. **ä¸€å°å¤šé—œè¯**: User â†’ Categories, User â†’ Accounts, Account â†’ Transactions
2. **è‡ªé—œè¯**: Category çš„éšå±¤çµæ§‹ (ä½¿ç”¨ parentId)
3. **è³‡æ–™åº«äº¤æ˜“**: ä½¿ç”¨ `sequelize.transaction()` ç¢ºä¿è³‡æ–™ä¸€è‡´æ€§
4. **è¤‡é›œæŸ¥è©¢**:
   - èšåˆå‡½æ•¸ (SUM, COUNT)
   - GROUP BY
   - æ—¥æœŸç¯„åœæŸ¥è©¢ (Op.between)
   - å¤šå±¤ include é—œè¯æŸ¥è©¢

### å¾Œç«¯é–‹ç™¼æŠ€å·§

1. **èªè­‰**: JWT token é©—è­‰
2. **å¯†ç¢¼å®‰å…¨**: bcrypt åŠ å¯†
3. **æ’ç¨‹ä»»å‹™**: node-cron å®šæ™‚åŸ·è¡Œ
4. **Email ç™¼é€**: Nodemailer æ•´åˆ
5. **æª”æ¡ˆç”Ÿæˆ**: ExcelJS ç”¢ç”Ÿå ±è¡¨
6. **éŒ¯èª¤è™•ç†**: çµ±ä¸€çš„éŒ¯èª¤è™•ç†æ©Ÿåˆ¶
7. **è¼¸å…¥é©—è­‰**: é˜²æ­¢ç„¡æ•ˆè³‡æ–™

### æ¥­å‹™é‚è¼¯

1. äº¤æ˜“è¨˜éŒ„èˆ‡å¸³æˆ¶é¤˜é¡çš„åŒæ­¥æ›´æ–°
2. ä¿¡ç”¨å¡æœªå‡ºå¸³é‡‘é¡è¿½è¹¤
3. è‡ªå‹•æé†’ç³»çµ±
4. çµ±è¨ˆè³‡æ–™è¨ˆç®—

---

## ğŸ“š åƒè€ƒè³‡æº

### Sequelize æ–‡ä»¶

- [Associations](https://sequelize.org/docs/v6/core-concepts/assocs/)
- [Transactions](https://sequelize.org/docs/v6/other-topics/transactions/)
- [Querying](https://sequelize.org/docs/v6/core-concepts/model-querying-basics/)

### å¥—ä»¶æ–‡ä»¶

- [Nodemailer](https://nodemailer.com/)
- [node-cron](https://github.com/node-cron/node-cron)
- [ExcelJS](https://github.com/exceljs/exceljs)
- [bcrypt](https://github.com/kelektiv/node.bcrypt.js)
- [jsonwebtoken](https://github.com/auth0/node-jsonwebtoken)

```json
{
  "dependencies": {
    "express": "^4.18.0",
    "sequelize": "^6.35.0",
    "pg": "^8.11.0",
    "pg-hstore": "^2.3.4",
    "bcrypt": "^5.1.1",
    "jsonwebtoken": "^9.0.2",
    "nodemailer": "^6.9.0",
    "exceljs": "^4.4.0",
    "node-cron": "^3.0.3",
    "dotenv": "^16.3.1"
  },
  "devDependencies": {
    "nodemon": "^3.0.0"
  }
}
```

## ğŸ” ç’°å¢ƒè®Šæ•¸ (.env)

```env
# Database
DB_HOST=localhost
DB_PORT=5432
DB_NAME=expense_tracker
DB_USER=your_user
DB_PASSWORD=your_password

# JWT
JWT_SECRET=your_secret_key

# Email (Gmail)
EMAIL_USER=your_email@gmail.com
EMAIL_PASSWORD=your_app_password

# Server
PORT=3000
NODE_ENV=development
```

## ğŸ“Œ æ³¨æ„äº‹é …

- æ‰€æœ‰é‡‘é¡ä½¿ç”¨ `DECIMAL(10, 2)` ç¢ºä¿ç²¾ç¢ºåº¦
- æ–°å¢/åˆªé™¤/æ›´æ–°äº¤æ˜“æ™‚,å¿…é ˆä½¿ç”¨è³‡æ–™åº«äº¤æ˜“ (`sequelize.transaction()`) ç¢ºä¿é¤˜é¡æ­£ç¢º
- Gmail éœ€è¦ä½¿ç”¨ã€Œæ‡‰ç”¨ç¨‹å¼å¯†ç¢¼ã€è€Œéå¸³è™Ÿå¯†ç¢¼
- Excel åŒ¯å‡ºæ™‚æ³¨æ„è¨˜æ†¶é«”ä½¿ç”¨,å¤§é‡è³‡æ–™å»ºè­°åˆ†æ‰¹è™•ç†
- ä¿¡ç”¨å¡æé†’ä½¿ç”¨ `lastNotifiedAt` é¿å…åŒä¸€å¤©é‡è¤‡ç™¼é€
- åˆ†é¡åˆªé™¤æ™‚éœ€æª¢æŸ¥æ˜¯å¦æœ‰äº¤æ˜“è¨˜éŒ„ä½¿ç”¨è©²åˆ†é¡

```

```
